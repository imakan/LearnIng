> 我们都知道JS是单线程的，同一时刻JS主程只能执行一件事情，那我们有网路请求，有`UI`渲染、有用户交互等等，怎么办呢，事件循环就可以帮我们解决这些事情

# 为什么`JS`是单线程

`JS`的主要运行宿主是浏览器，我们知道`JS`的主要用途之一是操作`DOM`，如果说是多线程的，如果我们同时操作一个`DOM`，会造成问题，要加死锁，所以为了避免这种情况，`JS`是单线程。


# 执行栈与任务队列

我们知道当`JS`执行的时候，分为堆(`heap`)和栈(`stack`)，堆中放一些对象，而栈中放一些基础变量以及对象的指针，当我们调用一些方法的时候，执行栈会生成一个他的`context`，这个执行上下文包含其作用域，上传作用域的执行，方法的参数这个作用域中定义的变量以及这个作用域的`this`对象。但是当我们有一系列方法的时候，但是`JS`是单线程的，同一时刻只能执行一个方法，所以其他的方法都被排队在一个单独的地方，这个地方叫做执行栈。


当我们执行一个方法的时候，执行栈就会加入这个方法的执行环境，在这个执行环境中我们也可以加入其他的方法，其实就是在这个执行栈中加入另外的执行环境，这个过程可以无限的增加，但是会发生溢栈的情况，也就是加入的大小超出了内存的大小，这里可以解释为什么闭包会内存溢出的情况。

上面我们说的都是同步代码，那如果有一个异步代码过来了呢，`JS`的另一个特点就是非阻塞，也就是所`JS`执行栈不会等待这个异步方法的执行结果，`JS`会把这个事件加入到与当前执行栈不同的一个队列中，这个队列我们称为事件队列，加入到事件队列的方法不会立即执行，会等到执行栈中的同步代码执行完后，主线程处于闲置状态才会去查看任务队列中是否有任务。如果有，执行栈就会把任务队列中的排名第一的拿出来，并把这个事件放入到执行占中， 然后执行其的同步代码。